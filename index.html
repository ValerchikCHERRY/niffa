<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bets - Crypto Investments</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --bg-primary: #121212;
            --bg-secondary: #1e1e1e;
            --bg-tertiary: #2a2a2a;
            --accent: #6a41ed;
            --accent-hover: #7d55ff;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --positive: #4caf50;
            --negative: #f44336;
            --warning: #ff9800;
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            padding: 16px;
            max-width: 500px;
            margin: 0 auto;
            position: relative;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Header Styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 24px;
            color: var(--accent);
        }

        .logo h1 {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .balance-container {
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .balance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .balance-title {
            font-size: 16px;
            color: var(--text-secondary);
        }

        .toggle-balance {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
        }

        .toggle-balance:hover {
            color: var(--text-primary);
        }

        .balance-amount {
            font-size: 26px;
            font-weight: 700;
            margin-bottom: 4px;
            letter-spacing: 0.5px;
        }

        .balance-change {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .positive {
            color: var(--positive);
        }

        .balance-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border-radius: var(--border-radius);
            border: none;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            color: var(--text-primary);
            background-color: var(--bg-tertiary);
        }

        .btn-primary {
            background-color: var(--accent);
        }

        .btn-primary:hover {
            background-color: var(--accent-hover);
        }

        /* Navigation */
        .navigation {
            display: flex;
            justify-content: space-around;
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 8px;
            margin-bottom: 10px;
        }

        .nav-btn {
            padding: 12px 20px;
            border-radius: 8px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            flex: 1;
            text-align: center;
        }

        .nav-btn.active {
            background-color: var(--accent);
            color: var(--text-primary);
        }

        /* Page Content */
        .page {
            display: none;
            flex-direction: column;
            gap: 20px;
        }

        .page.active {
            display: flex;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        /* Portfolio Styles */
        .chart-placeholder {
            height: 150px;
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-weight: 600;
            margin-bottom: 20px;
        }

        .open-bundles {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bundle {
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 16px;
            transition: var(--transition);
            cursor: pointer;
        }

        .bundle:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }

        .bundle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .bundle-title {
            font-weight: 700;
            font-size: 18px;
        }

        .bundle-profit {
            font-weight: 700;
            font-size: 16px;
            color: var(--positive);
        }

        .bundle-details {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            margin-bottom: 15px;
            font-size: 14px;
        }

        .bundle-structure {
            display: flex;
            height: 30px;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .asset {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
        }

        .bundle-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .bundle-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background-color: var(--warning);
        }

        .close-btn {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-btn:hover {
            background-color: var(--negative);
        }

        /* Marketplace Styles */
        .filters-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .sorting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sort-label {
            font-size: 16px;
            color: var(--text-secondary);
        }

        .sort-select {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            font-size: 14px;
            cursor: pointer;
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .filter-btn {
            padding: 8px 16px;
            border-radius: 20px;
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-btn.active {
            background-color: var(--accent);
        }

        .recommended-bundles {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .bundle-invest {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .bundle-invest:hover {
            background-color: var(--accent);
        }

        .min-invest {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .time-remaining {
            font-size: 14px;
            color: var(--warning);
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 8px;
        }

        /* Settings Styles */
        .settings-section {
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .profile-pic {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .profile-info h2 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .profile-info p {
            color: var(--text-secondary);
        }

        .settings-group {
            margin-bottom: 25px;
        }

        .settings-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-label {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-label i {
            font-size: 18px;
            width: 24px;
            color: var(--accent);
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-tertiary);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--accent);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 400px;
            padding: 25px;
            position: relative;
            animation: modalAppear 0.3s ease;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 700;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--text-primary);
        }

        .modal-body {
            margin-bottom: 25px;
        }

        .modal-footer {
            display: flex;
            gap: 10px;
        }

        .btn-cancel {
            background-color: var(--bg-tertiary);
        }

        .btn-confirm {
            background-color: var(--accent);
        }

        .btn-cancel:hover, .btn-confirm:hover {
            opacity: 0.9;
        }

        /* History Styles */
        .history-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .history-item {
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .history-type {
            font-weight: 600;
            font-size: 16px;
        }

        .history-date {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .history-amount {
            font-weight: 700;
            font-size: 18px;
        }

        .positive-amount {
            color: var(--positive);
        }

        .negative-amount {
            color: var(--negative);
        }

        /* Responsive */
        @media (min-width: 768px) {
            .recommended-bundles {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-bat"></i>
                <h1>Bets</h1>
            </div>
        </div>

        <!-- Balance Card (Smaller version) -->
        <div class="balance-container">
            <div class="balance-header">
                <div class="balance-title">Total Balance</div>
                <button class="toggle-balance" id="toggleBalance">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
            <div class="balance-amount" id="balanceAmount">$1,245.80</div>
            <div class="balance-change">
                <i class="fas fa-caret-up positive"></i>
                <span class="positive">+2.5%</span> last 24h
            </div>
            <div class="balance-actions">
                <button class="btn btn-primary" id="depositBtn">Deposit</button>
                <button class="btn" id="withdrawBtn">Withdraw</button>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <button class="nav-btn active" data-page="portfolio">Portfolio</button>
            <button class="nav-btn" data-page="marketplace">Marketplace</button>
            <button class="nav-btn" data-page="settings">Settings</button>
        </div>

        <!-- Portfolio Page -->
        <div class="page active" id="portfolioPage">
            <div class="chart-placeholder">
                <i class="fas fa-chart-line"></i>
                <span>Balance Chart</span>
            </div>

            <h2 class="section-title">Open Bundles</h2>
            <div class="open-bundles">
                <!-- Bundle 1 -->
                <div class="bundle">
                    <div class="bundle-header">
                        <div class="bundle-title">Low Risk BTC/ETH</div>
                        <div class="bundle-profit">+8.2%</div>
                    </div>
                    <div class="bundle-details">
                        <div>Duration: 6h</div>
                        <div>Risk: Low</div>
                    </div>
                    <div class="bundle-structure">
                        <div class="asset" style="background-color: #f7931a; width: 60%;">BTC 60%</div>
                        <div class="asset" style="background-color: #627eea; width: 30%;">ETH 30%</div>
                        <div class="asset" style="background-color: #26a17b; width: 10%;">USDT 10%</div>
                    </div>
                    <div class="bundle-footer">
                        <div class="bundle-status">Active</div>
                        <button class="close-btn">Close</button>
                    </div>
                </div>

                <!-- Bundle 2 -->
                <div class="bundle">
                    <div class="bundle-header">
                        <div class="bundle-title">High Growth Altcoins</div>
                        <div class="bundle-profit">+15.7%</div>
                    </div>
                    <div class="bundle-details">
                        <div>Duration: 12h</div>
                        <div>Risk: Medium</div>
                    </div>
                    <div class="bundle-structure">
                        <div class="asset" style="background-color: #00d395; width: 40%;">SOL 40%</div>
                        <div class="asset" style="background-color: #5d78ff; width: 35%;">DOT 35%</div>
                        <div class="asset" style="background-color: #f3ba2f; width: 25%;">BNB 25%</div>
                    </div>
                    <div class="bundle-footer">
                        <div class="bundle-status">Active</div>
                        <button class="close-btn">Close</button>
                    </div>
                </div>
            </div>

            <h2 class="section-title">Transaction History</h2>
            <div class="history-container">
                <div class="history-item">
                    <div class="history-info">
                        <div class="history-type">Deposit</div>
                        <div class="history-date">Today, 10:30 AM</div>
                    </div>
                    <div class="history-amount positive-amount">+$500.00</div>
                </div>
                <div class="history-item">
                    <div class="history-info">
                        <div class="history-type">Bundle Closed</div>
                        <div class="history-date">Yesterday, 5:45 PM</div>
                    </div>
                    <div class="history-amount positive-amount">+$82.50</div>
                </div>
                <div class="history-item">
                    <div class="history-info">
                        <div class="history-type">Withdrawal</div>
                        <div class="history-date">Mar 12, 2:15 PM</div>
                    </div>
                    <div class="history-amount negative-amount">-$200.00</div>
                </div>
            </div>
        </div>

        <!-- Marketplace Page -->
        <div class="page" id="marketplacePage">
            <h2 class="section-title">Available Bundles</h2>
            
            <div class="filters-container">
                <div class="sorting-row">
                    <div class="sort-label">Sort by:</div>
                    <select class="sort-select" id="sortSelect">
                        <option value="profit">Highest Profit</option>
                        <option value="risk">Lowest Risk</option>
                        <option value="start">Starting Soon</option>
                        <option value="duration">Shortest Duration</option>
                    </select>
                </div>
                
                <div class="filters">
                    <button class="filter-btn active">All</button>
                    <button class="filter-btn">Low Risk</button>
                    <button class="filter-btn">High Profit</button>
                    <button class="filter-btn">Short Term</button>
                    <button class="filter-btn">Crypto</button>
                </div>
            </div>
            
            <div class="recommended-bundles" id="bundlesContainer">
                <!-- Bundles will be generated dynamically -->
            </div>
        </div>

        <!-- Settings Page -->
        <div class="page" id="settingsPage">
            <div class="settings-section">
                <div class="settings-header">
                    <div class="profile-pic">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="profile-info">
                        <h2>John Crypto</h2>
                        <p>@john_crypto</p>
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">Security</h3>
                    <div class="settings-item">
                        <div class="settings-label">
                            <i class="fas fa-envelope"></i>
                            <span>Email Verification</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <i class="fas fa-shield-alt"></i>
                            <span>2FA Authentication</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <i class="fas fa-eye-slash"></i>
                            <span>Hide Balance</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">Preferences</h3>
                    <div class="settings-item">
                        <div class="settings-label">
                            <i class="fas fa-globe"></i>
                            <span>Language</span>
                        </div>
                        <div>English</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <i class="fas fa-bell"></i>
                            <span>Notifications</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">Information</h3>
                    <div class="settings-item">
                        <div class="settings-label">
                            <i class="fas fa-file-alt"></i>
                            <span>Terms of Service</span>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <i class="fas fa-lock"></i>
                            <span>Privacy Policy</span>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <i class="fas fa-question-circle"></i>
                            <span>FAQ & Support</span>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div class="modal" id="depositModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Deposit Funds</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Deposit USDT to your account to start investing.</p>
                <div style="margin: 20px 0; text-align: center;">
                    <div style="background-color: #1e1e1e; padding: 20px; border-radius: 12px; font-family: monospace; word-break: break-all;">
                        0x742d35Cc6634C0532925a3b844Bc454e4438f44e
                    </div>
                    <p style="margin-top: 10px; color: #b0b0b0; font-size: 14px;">Send only USDT to this address</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel close-modal">Cancel</button>
                <button class="btn btn-confirm" id="copyAddress">Copy Address</button>
            </div>
        </div>
    </div>

    <!-- Invest Modal -->
    <div class="modal" id="investModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Confirm Investment</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>You're about to invest in:</p>
                <h4 style="margin: 15px 0; text-align: center;" id="modalBundleName">Low Risk BTC/ETH</h4>
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <div>Target Profit:</div>
                    <div style="font-weight: 700; color: #4caf50;" id="modalBundleProfit">+8.2%</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <div>Duration:</div>
                    <div id="modalBundleDuration">6 hours</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <div>Risk Level:</div>
                    <div id="modalBundleRisk">Low</div>
                </div>
                <div style="margin-bottom: 15px;">
                    <div>Closing in: <span id="modalBundleTime" style="color: #ff9800; font-weight: 600;">12:34</span></div>
                </div>
                <div style="margin-top: 20px;">
                    <label for="investAmount">Investment Amount (USDT)</label>
                    <input type="number" id="investAmount" placeholder="Enter amount" style="width: 100%; padding: 12px; margin-top: 8px; border-radius: 8px; background-color: #2a2a2a; border: 1px solid #333; color: white; font-size: 16px;">
                    <div style="margin-top: 5px; font-size: 14px; color: #b0b0b0;" id="minInvestInfo">Min: $5.00</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel close-modal">Cancel</button>
                <button class="btn btn-confirm" id="confirmInvest">Confirm</button>
            </div>
        </div>
    </div>

    <script>
  // ===== КОНФИГУРАЦИЯ =====
  const API_URL = "https://script.google.com/macros/s/AKfycbyg9ImJ8Z3p6CZafwyS-lXGLnmfmRrenB5DoDMN5UoOvnw9oyR7XBbqq3-unUnmkfQo/exec";
  const SECURE_TOKEN = "SECURE_TOKEN_123"; // Замените на ваш токен

  // ===== БАЗОВЫЕ ФУНКЦИИ =====
  function showNotification(message, isError = false) {
    // ... существующий код нотификаций ... 
  }

  // Упрощенная dbRequest
  async function dbRequest(action, table, data = {}) {
    try {
      const response = await fetch(API_URL, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ action, table, record: data, token: SECURE_TOKEN })
      });
      return await response.json();
    } catch (error) {
      console.error("DB Error:", error);
      showNotification("Database error. Please try again later.", true);
      return null;
    }
  }

  // ===== ВОССТАНОВЛЕНИЕ ОБРАБОТЧИКОВ КНОПОК =====
  function restoreEventHandlers() {
    // 1. Кнопка показа/скрытия баланса
    document.getElementById('toggleBalance')?.addEventListener('click', toggleBalanceVisibility);
    
    // 2. Кнопки навигации
    document.querySelectorAll('.nav-btn').forEach(button => {
      button.addEventListener('click', switchPage);
    });
    
    // 3. Кнопки депозита и вывода
    document.getElementById('depositBtn')?.addEventListener('click', showDepositModal);
    document.getElementById('withdrawBtn')?.addEventListener('click', showWithdrawModal);
    
    // 4. Кнопки инвестирования
    document.querySelectorAll('.bundle-invest').forEach(btn => {
      btn.addEventListener('click', handleInvestmentClick);
    });
    
    // 5. Кнопки закрытия модальных окон
    document.querySelectorAll('.close-modal').forEach(btn => {
      btn.addEventListener('click', closeAllModals);
    });
    
    // 6. Кнопки закрытия сборок
    document.querySelectorAll('.close-btn').forEach(btn => {
      btn.addEventListener('click', handleCloseBundle);
    });
    console.log("Elements check:");
    console.log("Toggle balance:", document.getElementById('toggleBalance'));
    console.log("Nav buttons:", document.querySelectorAll('.nav-btn').length);
    console.log("Deposit button:", document.getElementById('depositBtn'));
  }

  // ===== РЕАЛИЗАЦИЯ ОБРАБОТЧИКОВ =====
  function toggleBalanceVisibility() {
    const balance = document.getElementById('balanceAmount');
    if (balance.textContent.includes('*')) {
      balance.textContent = '$1,245.80';
      this.innerHTML = '<i class="fas fa-eye"></i>';
    } else {
      balance.textContent = '******';
      this.innerHTML = '<i class="fas fa-eye-slash"></i>';
    }
  }

  function switchPage() {
    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
    
    this.classList.add('active');
    const pageId = this.dataset.page + 'Page';
    document.getElementById(pageId).classList.add('active');
  }

  function showDepositModal() {
    document.getElementById('depositModal').classList.add('active');
  }

  function showWithdrawModal() {
    // Заглушка для функционала вывода
    alert('Withdrawal functionality will be implemented soon');
  }

  function handleInvestmentClick(e) {
    const bundleCard = e.target.closest('.bundle');
    if (bundleCard) {
      const title = bundleCard.querySelector('.bundle-title').textContent;
      const profit = bundleCard.querySelector('.bundle-profit').textContent;
      
      document.getElementById('modalBundleName').textContent = title;
      document.getElementById('modalBundleProfit').textContent = profit;
      document.getElementById('investModal').classList.add('active');
    }
  }

  function closeAllModals() {
    document.querySelectorAll('.modal').forEach(modal => {
      modal.classList.remove('active');
    });
  }

  function handleCloseBundle(e) {
    e.stopPropagation();
    const bundle = e.target.closest('.bundle');
    const title = bundle.querySelector('.bundle-title').textContent;
    
    if (confirm(`Are you sure you want to close "${title}"?`)) {
      bundle.remove();
      showNotification(`"${title}" closed successfully!`, false);
    }
  }

  // ===== ИНИЦИАЛИЗАЦИЯ =====
  document.addEventListener('DOMContentLoaded', () => {
    // Восстановление обработчиков
    restoreEventHandlers();
    
    // Инициализация таймеров
    initTimers();
    
    // Тест работы базы данных (опционально)
    testDbConnection();
  });

  // ===== ФУНКЦИИ ДЛЯ РАБОТЫ С БД (ПРОСТОЙ ВАРИАНТ) =====
  async function testDbConnection() {
    try {
      const result = await dbRequest('read', 'Users', {});
      console.log('DB connection test:', result);
    } catch (error) {
      console.error('DB test failed:', error);
    }
  }

  // ===== ТАЙМЕРЫ СБОРОК =====
  function initTimers() {
    document.querySelectorAll('[id^="timer-"]').forEach(timer => {
      const seconds = 1800; // 30 минут
      startTimer(timer, seconds);
    });
  }

  function startTimer(element, seconds) {
    let remaining = seconds;
    const interval = setInterval(() => {
      remaining--;
      const mins = Math.floor(remaining / 60);
      const secs = remaining % 60;
      element.textContent = `Closing in: ${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      
      if (remaining <= 0) {
        clearInterval(interval);
        element.textContent = "Closed for investment";
        element.style.color = "#f44336";
        element.closest('.bundle')?.querySelector('.bundle-invest')?.setAttribute('disabled', 'true');
      }
    }, 1000);
  }
</script>
</body>
</html>
